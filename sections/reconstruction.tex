\chapter{Event reconstruction}
\label{ch:reconstruction}

\intro{The reconstruction of basic analysis objects within an event is described in this chapter. A key ingredient in the \gls{cms} reconstruction is the \acrfull{pf} algorithm which forms particle candidates by combining various subdetector information for a global event interpretation, thus improving the identification, spatial resolution, and energy measurement of particles. The focus is set on the reconstruction and performance of muons, electrons, jets, and the missing transverse energy in 8 and 13~TeV \gls{pp} collision data which are the input objects in this thesis to study single-top-quark production. The chapter is concluded by a summary of corrections to enhance the agreement between data and simulation.}

The event reconstruction attempts to build and identify basic analysis objects from the raw detector data. In \gls{cms}, basic objects are charged-particle tracks, vertices, charged leptons, photons, and jet candidates. During the reconstruction, additional information such as the missing transverse energy, $\met$, and the likelihood of jets to originate from the hadronization of b~quarks~(``b-tagging'') is determined. Since tau leptons have not been utilized and photons are not relevant in this study of $t$-channel single-top-quark production, a description of their reconstruction and performance is omitted here yet details can be found in Refs.~\cite{Khachatryan:2015dfa,Khachatryan:2015iwa}.


%##############################################
\section{Track reconstruction}
%##############################################
\label{sec:reconstruction-track}

The reconstruction of tracks from the readout of the inner tracking system is split in two steps. First, in the local reconstruction, hits from charge distributions on the pixel and strip modules are formed. Then, in the global reconstruction, trajectory candidates are first seeded and then sequentially built from the inside out. Finally, a helix track is fitted through the associated hits per trajectory candidate to estimate the particle's momentum and charge through its curvature in the magnetic solenoid field. The individual steps are described briefly in the following. More details can be found in Ref.~\cite{Chatrchyan:2014fea}.

Different algorithms are used to determine the local positions of two-dimensional (one-dimensional) hits from the distributions of charge deposits on the pixel (strip) modules, respectively. The pixel hit positions are estimated first with a fast algorithm whose outcome is utilized in the trajectory seeding and building stage only. It projects the 2D charge distributions onto each axis and estimates the positions from the charges at the edges of each charge cluster while accounting for their Lorentz-drift within the modules. During the track-fit stage, the optimal pixel hit positions are estimated instead by comparing the charge distributions against the expectations from simulated templates for various track incident angles~\cite{Swartz:2007zz}. In the barrel layers, the pixel hit resolution is measured as $9.4~\upmu\mathrm{m}$ in $\mathrm{r}\mbox{-}\phi$ and ranges between $21\range45~\upmu\mathrm{m}$ along the z-axis depending on the incident angle~\cite{Chatrchyan:2014fea}. 

For reconstructing hits on the strip modules, charge clusters are formed if the channel readout of adjacent strips is sufficiently above their individual noise levels. The hit position is then calculated as a charge-weighted average over a cluster while correcting for the Lorentz drift and potential inefficiencies which occur at the edges of a module. The hit resolution depends on the size of a cluster and the strip-to-strip distance of the modules~(Sec.~\ref{sec:experiment-tracker}). It ranges roughly between $10\range30~\upmu\mathrm{m}$ ($10\range50~\upmu\mathrm{m}$) for the \gls{tib} (\gls{tob}) modules, respectively~\cite{Chatrchyan:2014fea}.

The reconstruction of tracks is performed in multiple passes, called iterations, over the pixel and strip hit collection to reduce the combinatorial complexity. Each iteration consists of the same algorithmic steps---seeding, trajectory finding, track fitting, and selection---but is configured differently. The first iterations attempt to reconstruct only simple tracks which originate close to the interaction region and have a sufficiently large transverse momentum. The hits belonging to successfully reconstructed tracks are then masked in subsequent iterations to reduce the number of hit combinations. Later iterations focus on finding displaced or low momentum tracks which may not originate from the interaction region using the remaining hits. Figure~\ref{fig:reconstruction-trackingiter} shows the efficiency times acceptance for successfully reconstructing a track\footnote{Tracks are reconstructed ``successfully'' if at least 75\% of their hits can be associated to a simulated particle.} in simulation, broken down per iteration, as a function of its transverse momentum or displacement.

\myfigure{\label{fig:reconstruction-trackingiter}The efficiency times acceptance of successfully reconstructing a track in simulation per tracking iteration as a function of (a)~the transverse momentum and (b)~the transverse displacement. The figures are taken from Ref.~\cite{trackingpublic}.}{
\subfloat[]{\includegraphics[width=0.48\textwidth]{figures/reconstruction/tracking_vs_pt.jpg}}\hspace{0.03\textwidth}
\subfloat[]{\includegraphics[width=0.48\textwidth]{figures/reconstruction/tracking_vs_vertpos.jpg}}
}

Each iteration commences by forming a trajectory seed from a hit doublet or triplet where only certain combinations of tracker layers are allowed depending on the iteration. First iterations utilize mostly 3D hits on the pixel layers for seeding since their low channel occupancy results in less ambiguity and a higher efficiency for close-by tracks. Late iterations use hits from the strips modules instead where the spatial track density is low. Here, 3D matched hits are utilized mostly which stem from double-sided strip modules but also mono layers are allowed. The final seed candidate has to fulfill certain quality criteria like a minimal transverse momentum and compatibility with either the beam spot or a preliminary reconstructed vertex depending on the iteration.

Each seed contains enough information to perform a first estimate of the track parameters. Then an algorithm, called \glshere{ctf}, extrapolates the trajectory estimate of the seed to find additional hits on subsequent layers which are compatible with the track hypothesis. The \gls{ctf} algorithm is based on the \glshere{kf} technique~\cite{Fruhwirth:1987fm,Billoir:1989mh,BILLOIR1990219} which describes how to update the track parameters and their uncertainties iteratively after adding a hit to the trajectory candidate. If multiple compatible hits are found on a layer, the trajectory is cloned for each of them. If no compatible hit is found on a layer a ghost hit is created instead.

The hits per trajectory are then passed to a \gls{kf}-based helix fit to estimate the track parameters without utilizing the initial estimate from the seed. In addition, the fit accounts for material effects and the inhomogeneous magnetic field.  The fitted tracks have to pass a quality selection to reduce the amount of fake tracks before they are considered in physics analyses. The criteria reflect the seed requirements and depend additionally on e.g., the total number of 2D/3D hits, the $\chi^2/\mathrm{\gls{ndof}}$ of the fit, the amount of ghost hits, and the amount of shared hits with other tracks amongst others.

The tracking efficiency for isolated muon tracks with $1<\pt<100~\GeV$ is found to be above $99\%$ over the full tracker acceptance since their trajectories are only disturbed by energy loss through ionization and Coulomb scattering. The trajectories of charged hadrons like pions are additionally affected by nuclear interactions, especially at low momenta ($\pt<700~\MeV$), which results in efficiencies between $80\range95\%$~\cite{Chatrchyan:2014fea}. For electrons, a special tracking is performed on top of the standard one (described in Sec.~\ref{sec:reconstruction-electrontracks}) which attempts to recover cases where the electron looses large amounts of energy via bremsstrahlung. In parts of the 2016 collision data the overall tracking efficiency decreased by about $2\range6\%$ at high instantaneous luminosities of $(1.0\range1.2)\cdot10^{34}~\mathrm{cm}^{-2}\mathrm{s}^{-1}$ due to a charge saturation effect on the readout chips leading to missing hits. This was however recovered by adjusting the voltage which controls the charge drain speed of the tracker modules. For already collected data, the effect has been mitigated offline while any residual loss of efficiency is known and accounted for through dedicated scale factors.

%##############################################
\subsection{Muon tracks}
%##############################################
\label{sec:reconstruction-muontracks}

The track reconstruction for muons begins with the local reconstruction of hits in the three muon systems~\cite{Bayatian:922757}. The positions of hits in the \gls{dt} system are reconstructed by first forming independent segments in $r\text{-}\phi$ and $r\text{-}z$ through a combination of pattern recognition and linear fitting steps which are then combined in a second step. For the \glspl{csc}, independent 2D hits are reconstructed at wire--strip intersections in each of the six layers which are then combined into a track segment through a linear fit. Hits in the \gls{rpc} modules are built from clusters of active strips where their positions are taken as the center of gravity of the cluster's area.

Standalone muon tracks are built from the information of the muon systems without utilizing the inner tracker. The tracking starts by generating seeds from a linear fit through hits in the \gls{dt} and \gls{csc} systems. Then, a \gls{kf}-based track fit is carried out, taking as starting point the seeds while also utilizing the hits in the \gls{rpc} system. In addition, the resulting track is constrained to be close to the beam spot which improves the momentum resolution. A region of interest inside the inner tracker is defined by extrapolating the standalone muon track inwards. Starting from trajectory seeds inside this region, a global muon trajectory is built and fitted which utilizes also compatible hits from the inner tracker.


%##############################################
\subsection{Electron tracks}
%##############################################
\label{sec:reconstruction-electrontracks}

The primary loss of energy for electrons occurs via bremsstrahlung within \gls{cms}. Typically, an electron radiates more than 70\% of its energy with a probability of 35\% in the inner tracker before reaching the \gls{ecal}. This leads to an increasingly curved electron trajectory in the magnetic field as a function its flight distance. The standard tracking is suboptimal for reconstructing such trajectories because the employed Kalman filtering assumes that the energy loss is Gaussian-distributed. Therefore, a different filtering algorithm, the so-called \glshere{gsf}~\cite{0954-3899-31-9-N01}, is utilized in the electron tracking reconstruction instead.

Seeds for the \gls{gsf} tracking are constructed in two ways. The first method creates \gls{ecal}-driven seeds by forming super clusters of \gls{ecal} crystals with a size of 0.09 in $\eta$ but $\pm0.3~\mathrm{rad}$ azimuthally to detect electrons together with their potentially radiated photons~\cite{CMS:2010aua}. The second method tries to identify electron tracks inside the standard track collection which are typically marked by either a poor fit quality if the energy loss was large or by its compatibility with an \gls{ecal} cluster otherwise. The resulting seeds from the two methods are selected to initiate the \gls{gsf} tracking. In its core, the algorithm book-keeps a set of trajectories which are subjected to the \gls{kf}-based tracking algorithm. Different Gaussian distributions are assumed per layer for the energy loss per trajectory while their sum is an approximation of the Bethe-Heitler formula describing the energy loss of electrons. After extrapolating a trajectory set to a new layer, incompatible trajectories are removed or merged with similar ones to limit the exponential growth to a maximum of 12 trajectories per set. The final electron track is estimated by utilizing the summed Gaussian distributions per layer as uncertainties in the track fit. 

The electron reconstruction efficiency has been measured in 8~TeV \gls{pp} collision data to be better than 93\% for electrons with an \gls{ecal} super cluster energy of $E_\mathrm{T}>20~\GeV$~\cite{Khachatryan:2015hwa}. A tracking efficiency of about 96\% is obtained for electrons with $E_\mathrm{T}>25~\GeV$ in 13~\TeV \gls{pp} collision data~\cite{CMS-DP-2017-004}.



%##############################################
\section{Vertex reconstruction}
%##############################################


The vertex reconstruction tries to locate points of \gls{pp} interactions which are identified by sets of close-by charged-particle tracks in the interaction region. In analyses, the association of tracks to vertices allows to separate tracks belonging to the hard scattering event from additional tracks which originate from pileup interactions instead.

The first step in the vertex reconstruction encompasses the forming clusters of spatially-close tracks. For this, tracks which are close to the beam spot are selected and supplied to a \glshere{da} algorithm~\cite{726788}. It is based on a statistical mechanics model where each track reflects a microstate. The association of a track to a vertex candidate is floating and controlled by a probability denoted $p_{i}$ in the following. A quantity

\begin{equation}
F=-T\sum_{i}^\mathrm{tracks}\,p_{i}\cdot\log\left(\sum_{j}^\mathrm{vertices}\,\rho_{j}\cdot\exp\left[-\frac{1}{T}\frac{\Big(z_{i}^\mathrm{(track)}-z_{j}^\mathrm{(vertex)}\Big)^2}{\sigma_{z,i}^2}\right]\right)\,,
\end{equation}
 
which is an analog of the free energy in a thermodynamical model, is monitored while decreasing the corresponding temperature $T$ of the system. Here, $z_{i}$ are the track/vertex positions, $\sigma_{i}$ denotes the uncertainty of the track positions, and $\rho_{k}$ is an additional weight to treat overlapping vertices effectively. A protovertex is split in two nearby ones if a minimum of the free energy is reached. The decrease of temperature is stopped when a trade-off between the expected spatial vertex resolution and the probability of splitting a proper vertex falsely is reached.

Finally, the optimal vertex positions are estimated through an adaptive vertex fit~\cite{0954-3899-34-12-N01} per cluster of tracks. The obtained vertices are referred to as ``primary vertices'' since they mark the point of a \gls{pp} interaction and are therefore lined up along the z-axis. The vertices are ordered by the summed $\pt^2$ of their associated tracks where the leading vertex is assigned to mark the hard interaction of interest while the others are treated as pileup interactions. In 2016 \gls{pp} collision data, the primary vertex resolution is measured as $\sigma_{z}\geq19~\upmu\mathrm{m}$ and $\sigma_{x,y}\geq14~\upmu\mathrm{m}$ for vertices whose summed \pt of associated tracks exceeds $100~\GeV$~\cite{CMS-DP-2016-041}.



%##############################################
\section{Particle flow}
%##############################################

\todo{cite new PF paper https://arxiv.org/abs/1706.04965}

A central element in the standard event reconstruction of \gls{cms} is the \glshere{pf} algorithm~\cite{CMS:2009nxa}. It aims at reconstructing global particle candidates like electrons, muons, photons, and charged and neutral hadrons in an event by tracing the flow of particles through the various subdetectors. The combination of the individual subdetector information leads to an improved spatial resolution, energy measurement, and type identification of particles while avoiding double counting.

The \gls{pf}-based reconstruction of particles consists of an algorithm to link several subdetector information together. The linked elements can be charged-particle tracks from the inner tracker, calorimeter clusters from the \gls{ecal} or \gls{hcal}, and muon tracks. The algorithm starts by extrapolating charged-particle tracks into the calorimeter systems. In the \gls{ecal}, the trajectories are extended to the expected depth of the shower maximum of an electron candidate whereas in the \gls{hcal}, the trajectories are extrapolated up to one interaction length. A link is created if a trajectory is located inside the boundaries of a compatible \gls{ecal} or \gls{hcal} cell cluster within uncertainties. Photon candidates, which could have been emitted tangentially from electron tracks, are also created by extrapolating straight tracks from intersections of the electron track with the tracker layers to compatible \gls{ecal} cells. For neutral particle candidates links between calorimeter clusters are formed. Here, the algorithm starts with \gls{ecal} or \gls{es} clusters for which a good resolution is expected due to their high granularity and extrapolates them to potential \gls{hcal} or \gls{ecal} clusters which have a coarser granularity, respectively. A link between a tracker track and the muon system is created if the described track reconstruction for muons~(Sec.~\ref{sec:reconstruction-muontracks}) yields an acceptable goodness-of-fit.

Identification of particles is performed by utilizing the linked blocks. First, global \gls{pf} muons are identified if their momenta are compatible with the corresponding tracker-only track momenta. Next, \gls{pf} electrons are identified through the \gls{gsf} tracking together with potential photons from bremsstrahlung. A \gls{pf} charged hadron candidate is created for each of the remaining \gls{pf} candidates that have a charged-particle track linked to it. Finally, the amount of neutral energy is determined by subtracting the charged particle energy fraction from the calibrated energy of the linked calorimeter clusters. This procedure yields \gls{pf} photon and \gls{pf} neutral hadron candidates depending on the excess of neutral energy in the \gls{ecal} and \gls{hcal} clusters, respectively. Outside the acceptance of the inner tracking system ($|\eta|>2.4$), no information on the particle's charge is available. Thus, only a simplified identification is performed by constructing either hadronic or \gls{em} \gls{pf} candidates only. In a pseudorapidity range of $2.4<|\eta|<3$, such candidates are formed from \gls{ecal}/\gls{hcal} clusters, whereas in $3<|\eta|<5$ the difference between the readouts of the long and short fibers of the \gls{hf} calorimeter allows to discriminate between these two types.

The improvement in spatial and energy resolution which is achieved through the \gls{pf} algorithm is demonstrated exemplary for jets in Fig.~\ref{fig:reconstruction-pfjets}. In particular, the energy resolution at low momenta is significantly improved compared to calorimeter jets since the energy estimation utilizes also the measured momenta of charged-particle tracks from the inner tracking system.

\myfigure{\label{fig:reconstruction-pfjets}Comparison of simulated calorimeter and particle flow jet performance: (a)~spatial resolution in $\eta$; (b)~energy resolution. The figures are taken from Ref.~\cite{CMS:2009nxa}.}{
\subfloat[]{\includegraphics[width=0.48\textwidth]{figures/reconstruction/pf_jeteta.pdf}}\hspace{0.03\textwidth}
\subfloat[]{\includegraphics[width=0.48\textwidth]{figures/reconstruction/pf_jetenergy.pdf}}
}

%##############################################
\section{Muons}
%##############################################
\label{sec:reconstruction-muons}

Identification of muon candidates for physics analyses is performed by requiring additional selection criteria. A detailed study of muon identification with 7~\TeV \gls{pp} collision data can be found in Ref.~\cite{Chatrchyan:2012xi}. Throughout the analyses within this thesis, muon candidates have to fulfill identification criteria which correspond to a ``tight'' working point yielding most genuine muons while rejecting falsely reconstructed ones. In the following, the criteria and performance of muon identification utilized in 8~TeV and 13~\TeV \gls{pp} collision data are briefly discussed~\cite{CMS-DP-2013-009,CMS-DP-2017-007}.

The global muon fit is required to included at least one valid hit in the muon chambers for which in addition at least two muon segments in two muon stations are present. Only muon tracks for which the global track fit yields a goodness-of-fit of $\chi^2/\mathrm{\gls{ndof}}<10$ are selected. The motivation behind these criteria is to reject fake muons from hadron showers that are not contained by the \gls{hcal} and reach the muon system~(so-called ``punch-throughs''). To suppress the decay of muons in flight, the muon track needs to consist of at least one pixel hit. Additionally, a minimum number of five hits in the tracker is required. A selection on the minimal distance of the muon track to the primary vertex of $d_{x,y}<2~\mathrm{mm}$ and $d_{z}<5~\mathrm{mm}$ is applied to reject cosmic muons and muons stemming from \gls{pu} interactions. A comparison of muon identification efficiencies for data and simulation is presented in Fig.~\ref{fig:reconstruction-idmuon}. These have been estimated using the tag-and-probe method for which $\mathrm{Z}\to\mu^{\rmplus}\mu^{\rmminus}$ events are selected where one muon is required to pass the identification criteria~(``tag''). It is then measured in how many instances the other muon fulfills the identification criteria as well~(``probe'') to infer the efficiency. The efficiency is found to be mostly between 95\range100\% with the exception of two dips at $0.2<|\eta|<0.3$ which occur due to a crack between the wheels of the \gls{dt} system. Overall, a fair agreement between data and simulation is observed. The residual differences are corrected in simulation by applying $(\pt,\eta)$-dependent scale factors ($\epsilon_\mathrm{data}/\epsilon_\mathrm{MC}$) to simulated events.

\myfigure{\label{fig:reconstruction-idmuon}Comparison of muon identification efficiencies of data and simulation as a function of the pseudorapidity of the muon for analyses at (a)~8~TeV and (b)~13~\TeV. The figures are taken from Refs.~\cite{CMS-DP-2013-009,CMS-DP-2017-007}.}{
\subfloat[]{\includegraphics[width=0.48\textwidth]{figures/reconstruction/muon_id8.pdf}}\hspace{0.03\textwidth}
\subfloat[]{\includegraphics[width=0.48\textwidth]{figures/reconstruction/muon_id13.pdf}}
}

Muon candidates in the analyses of single-top-quark production within this thesis are required to be spatially isolated from \gls{em} and hadronic activity in addition to the tight identification criteria. The relative \gls[format=hyperbf]{deltabeta}-based (``delta-beta'') isolation for muons is defined as

\begin{equation}
I_\mathrm{rel.}^{\mu}=\frac{I_\text{ch.-had.}+\max\Big(0,~I_{\gamma}+I_\text{neut.-had.}-\beta\cdot I_\text{\gls{pu}}\Big)}{\pt^\mu}\,,\qquad \beta=\frac{1}{2}\,,
\end{equation}

where $I_\text{ch.-had.}$, $I_{\gamma}$, and $I_\text{neut.-had.}$ denote the summed transverse energies of charged hadrons, photons, and neutral hadrons respectively within $\Delta R=\sqrt{\Delta\eta^{2}+\Delta\phi^{2}}<0.4$ around a muon candidate. The term $I_\text{\gls{pu}}$ is used to correct the amount of considered neutral energy. It denotes the summed transverse energies of charged-particle tracks within $\Delta R<0.4$ that are associated to pileup vertices. Hence, the applied correction $\beta\cdot I_\text{\gls{pu}}$ can be interpreted as an estimate of the amount of neutral energy from pileup interactions within $I_{\gamma}$ and $I_\text{neut.-had.}$. The chosen value for $\beta$ is motivated by assuming equal production rates for the ($\uppi^{\rmplus}$,$\uppi^{0}$,$\uppi^{\rmminus}$) isospin triplet leading to a ratio of $\frac{1}{2}$ for the production of neutral pions over charged ones. 


%##############################################
\section{Electrons}
%##############################################
\label{sec:reconstruction-electrons}

Similar to muon candidates, electron candidates are required to pass certain identification criteria as well. A study of the electron reconstruction and identification performances in 8~\TeV and 13~\TeV \gls{pp} collision data can be found in Refs.~\cite{Khachatryan:2015hwa,CMS-DP-2017-004}. The ``tight'' identification criteria, employed in this thesis, are elaborated briefly in the following.

A \gls{pf} electron candidate with a \gls{gsf} track is required. Candidates within the \gls{ecal} barrel-endcap transition region of $1.4442<|\eta|<1.5660$ are ignored. The electron track has to have a hit on the innermost tracker layer which prevents the selection of electrons from potential photon conversions~($\gamma\to\mathrm{e}^{\rmplus}\mathrm{e}^{\rmminus}$). An explicit photon conversion veto is applied by testing if a pair of electron tracks originates from a common displaced vertex. Further selection criteria are combined into a multivariate identification discriminant. It is based on various input observables like the \gls{gsf} track quality, the \gls{ecal} cluster shapes, their energy distribution, and the agreement between the independent cluster energy and track energy estimates. For 13~TeV data, the discriminant is replaced by a simplified cut-based version where multiple fined-tuned selections on similar observables are utilized. A comparison of the efficiency of electron identification in 8~TeV data and simulation, estimated from $\mathrm{Z}\to\mathrm{e}^{\rmplus}\mathrm{e}^{\rmminus}$ events using the tag-and-probe method, is shown in Fig.~\ref{fig:reconstruction-idelectron}. For transverse momenta above $30~\GeV$ the identification reaches efficiencies of $\approx95\%$. The small differences between data and simulation are corrected by dedicated scale factors as well similar to the treatment of muon identification efficiencies~(Sec.~\ref{sec:reconstruction-muons}).

\myfigure{\label{fig:reconstruction-idelectron}Comparison of the electron identification efficiency in data and simulation as a function of its transverse momentum. The figure is taken from Ref.~\cite{CMS-DP-2013-003}.}{
\includegraphics[width=0.65\textwidth]{figures/reconstruction/electron_idpt1.pdf}
}

An electron candidate is also required to be isolated from other \gls{em} and hadronic activity in its vicinity. The relative \gls[format=hyperbf]{effarea}-based (``effective area'') isolation for electrons is defined as

\begin{equation}
I_\mathrm{rel.}^\mathrm{e}=\frac{I_\text{ch.-had.}+\max\Big(0,~I_{\gamma}+I_\text{neut.-had.}-\rho\cdot A_\text{eff.}(\eta_\mathrm{SC})\Big)}{\pt^\mathrm{e}}\,,
\end{equation}

where the transverse energies $I_{X}$ per particle type $X$ are summed in a cone of $\Delta R<0.3$ around the electron candidate. The amount of neutral energy is corrected by the effective area $A_\text{eff.}$ times the median of the transverse energy density $\rho$ calculated in $\delta\eta\times\delta\phi$ from charged-particle tracks that are associated to pileup vertices. The effective area is estimated from simulation and denotes the expected amount of neutral energy from pileup interactions per $\rho$ within the isolation cone as a function of the pseudorapidity of the associated \gls{ecal} supercluster. The general idea behind the \gls{effarea}-based isolation for electrons is motivated by a proposed pileup subtraction method for jets which is detailed in Ref.~\cite{Cacciari:2007fd}.


%##############################################
\section{Jets}
%##############################################
\label{sec:reconstruction-jets}

Jets are clustered from \gls{pf} candidates with the exclusion of charged hadrons that are associated to pileup vertices. This procedure is referred to as \glshere{chs} technique~\cite{CMS-PAS-JME-14-001}. In addition, preselected isolated muons or electrons can be excluded from the jet clustering as well to prevent double counting of their momenta. For example, when studying the decay $\mathrm{t}\to \mathrm{b}\mu\nu$ a selected muon candidate should be prevented from being clustered into the b~jet. This approach has been chosen in the reconstruction of 8~TeV data, whereas in analyses of 13~TeV data a minimal $\Delta R$ distance between the final leptons and jets for analysis is required instead.

Jets are clustered using the iterative anti-\kt algorithm~\cite{Cacciari:2008gp}. In its initial step all candidates are considered to be so-called ``protojets''. At each iteration step the two distances

\begin{equation}
d_{ij}=\mathrm{min}\left(\frac{1}{p_{\mathrm{T},i}^{2}},\,\frac{1}{p_{\mathrm{T},j}^{2}}\right)\cdot\frac{\sqrt{\Delta\eta_{ij}^{2}+\Delta\phi_{ij}^{2}}}{\mathrm{R}^2}\,,\qquad d_{i}=\frac{1}{p_{\mathrm{T},i}^{2}}\,,
\end{equation}

are calculated for protojets $i$ and $j$.  If $d_{ij}$ is the smallest distance between two protojets in an iteration, they are merged and their 4-momenta are summed. If otherwise $d_{i}$ is found to be the smallest distance, the corresponding protojet is promoted to a final jet and ignored in subsequent steps. The parameter $\mathrm{R}$ controls the cone size of the resulting jets. In 8~TeV data, jets are clustered with $\mathrm{R}=0.5$ which was lowered to $\mathrm{R}=0.4$ in the reconstruction of 13~TeV data since the objects are more boosted due to the higher energy resulting into a smaller cone size.

In this thesis a ``loose'' jet identification is utilized. The criteria are motivated by the fact that a proper jet stemming from the hadronization of a quark or gluon consists of a multitude of \gls{pf} particles and types. The exact criteria are somewhat adjusted from one data taking period to the next. A few common requirements are detailed in the following. A jet should consists of more than one constituent and the neutral hadron and neutral \gls{em} energy fractions should be both less than $99\%$. In addition, for jets that fall within the tracker acceptance~($|\eta|<2.4$) at least one constituent has to be a charged hadron and the charged \gls{em} fraction is required to be less than $99\%$ amongst others. The identification efficiencies are found to be very close to 100\% for both data and simulation.

In data and simulation the energies of reconstructed jets are found to deviate from the energies of corresponding jets clustered from the hadronization products of true partons due to non-linear subdetector responses and efficiencies. Therefore, a series of \glsplhere{jec} are applied to relate the reconstructed energy to the true jet energy on average. The applied corrections are briefly outlined in the following, whereas a detailed discussion can be found in Ref.~\cite{Khachatryan:2016kdb}. The \glspl{jec} are multiplicative factors for rescaling the 4-momenta of jets. Multiple levels of corrections are applied to data and simulation sequentially. First, the offset correction removes the dependence of the jet energy response on the additional pileup activity within an event. It utilizes a hybrid of the jet area method~\cite{Cacciari:2007fd}. The correction factors are derived by comparing the jet responses in simulated events with and without pileup events overlaid. The next level of corrections aims to obtain a uniform energy response which is independent of the transverse momentum and pseudorapidity of a jet. The corrections are derived from simulated events by matching reconstructed jets to close-by true particle jets and comparing their momenta. Lastly, residual differences between data and simulation are corrected by comparing the $\pt$ balance in various  types of events~(multijet, \mbox{$\mathrm{Z}$+jets}, \mbox{$\gamma$+jets}) where one jet is restricted to be within the barrel region~($|\eta|<1.3$) to provide a reference. The total and individual uncertainties from the various corrections are shown in Fig.~\ref{fig:reconstruction-jec} for 8~\TeV and 13~\TeV data. At 8~\TeV, the uncertainty is found to be mostly around $1\%$ and only approaches $2\%$ for forwards jets~($|\eta|>3$) with low transverse momenta of $\pt\approx30~\GeV$, whereas larger uncertainties of 3\range5\% are found at 13~\TeV for jets with a transverse momentum of $30~\GeV$ and above. The optional jet flavor corrections, shown in the plots, have not been employed in the analyses within this thesis.

\myfigure[h!tb]{\label{fig:reconstruction-jec}Uncertainty on the \acrlongpl{jec} as a function of (left column)~the transverse momentum and (right column)~the pseudorapidity for \acrlongpl{cm} energies of (top row)~8~\TeV and (bottom row)~13~\TeV. The figures are taken from Refs.~\cite{Khachatryan:2016kdb,CMS-DP-2016-020}.}{
\subfloat[]{\includegraphics[width=0.48\textwidth]{figures/reconstruction/jet_uncpt.pdf}}\hspace{0.03\textwidth}
\subfloat[]{\includegraphics[width=0.48\textwidth]{figures/reconstruction/jet_unceta.pdf}}\\
\subfloat[]{\includegraphics[width=0.48\textwidth]{figures/reconstruction/jet_uncpt13.pdf}}\hspace{0.03\textwidth}
\subfloat[]{\includegraphics[width=0.48\textwidth]{figures/reconstruction/jet_unceta13.pdf}}
}

In addition to rescaling the jet energy, the \glshere{jer} is corrected for simulated jets to mimic the spread in $\pt$ as observed in data. Exemplary relative resolutions in terms of $\pt^\mathrm{reco.}/\pt^\mathrm{true}$ in 8~TeV simulation are presented in Fig.~\ref{fig:reconstruction-jer-spread} for various pileup scenarios. Two methods are used to rescale the reconstructed 4-momentum which are chosen whether or not a jet can be matched to a true jet in simulation. The factors are defined as

\begin{subequations}
\begin{align}
c_\mathrm{matched}&=1+\frac{\pt^\mathrm{reco.}-\pt^\mathrm{true}}{\pt^\mathrm{reco.}}\cdot\big(s_\mathrm{\gls{jer}}-1\big)\,,\\ c_\mathrm{unmatched}&=1+\mathsf{N}(0,\,\sigma_\mathrm{\gls{jer}})\cdot\sqrt{\mathrm{max}\big(s_\mathrm{\gls{jer}}^2-1,\,0\big)}\,,
\end{align}
\end{subequations}

where $\sigma_\mathrm{\gls{jer}}$ denotes the relative resolution in simulation and  $s_\mathrm{\gls{jer}}$ $\eta$-dependent resolution scale factors. The latter are determined from data by analyzing the $\pt$ balance in dijet or \mbox{$\gamma$+jets} events. Exemplary scale factors, obtained from 8~TeV data, are shown in Fig.~\ref{fig:reconstruction-jer-sf}. Similar scale factors are obtained from 13~\TeV data as well~\cite{CMS-DP-2016-020}. A random smearing of the jet energy is performed in case it cannot be matched to a true jet. Here, $\mathsf{N}(0,\,\sigma_\mathrm{\gls{jer}})$ denotes a sampled value from a normal distribution centered at zero with standard deviation $\sigma_\mathrm{\gls{jer}}$.

\myfigure{\label{fig:reconstruction-jer}Jet $\pt$-resolution correction: (a)~relative  spread in $\pt^\mathrm{reco.}/\pt^\mathrm{true}$ for different pileup scenarios as a function of the true jet momentum in simulation; (b)~resolution scale factors derived from 8~TeV data. The figures are taken from Ref.~\cite{Khachatryan:2016kdb}.}{
\subfloat[\label{fig:reconstruction-jer-spread}]{\includegraphics[width=0.49\textwidth]{figures/reconstruction/jer_res.pdf}}\hspace{0.03\textwidth}
\subfloat[\label{fig:reconstruction-jer-sf}]{\includegraphics[width=0.47\textwidth]{figures/reconstruction/jer_sf.pdf}}
}



%##############################################
\section{b-tagging}
%##############################################
\label{sec:reconstruction-btagging}

The identification of jets that stem from the hadronization of b~quarks, so-called ``b-tagging'', is a crucial ingredient in studies of top quark production. It provides discrimination power to single out jets which can be related to b~quarks as expected in top quark decays.

Multiple algorithms have been developed within \gls{cms} to perform b-tagging~\cite{Chatrchyan:2012jua,CMS-PAS-BTV-15-001} for jets that fall within the pseudorapidity acceptance of the tracker. A common feature of most algorithms is the identification of a secondary vertex, which is reconstructed from displaced tracks within a jet. The general idea is illustrated in Fig.~\ref{fig:reconstruction-btagging}. After hadronization, a final state b~quark is encapsulated into a B~meson~(e.g. $\mathrm{B}^{\pm}$, $\mathrm{B}_{0}$, $\mathrm{B}_\mathrm{s}$) which can then travel a measurable distance away from the primary vertex before decaying due to its relatively long lifetime. For example, a $\mathrm{B}^{\pm}$~meson, which has a mean lifetime of about $1.6~\mathrm{ps}$~\cite{Olive:2016xmw}, can travel distances of roughly $4\range9~\mathrm{mm}$ for momenta of $40\range100~\GeV$ on average before decaying.

\myfigure{\label{fig:reconstruction-btagging} Sketch of the production of displaced tracks in b~jets through the decay of a B~hadron.}{
\includegraphics[scale=0.65]{figures/reconstruction/btagging.pdf}
}

After reconstruction, secondary vertices are subjected to pass certain quality criteria to enhance their purity with respect to the B~meson hypothesis. These are based on the amount of shared tracks with the primary vertex, the invariant vertex mass to reject kaon decays, and the direction of tracks with respect to the jet axis. In this thesis, b-tagging algorithms based on multivariate discriminators are employed. These combine multiple properties of the secondary vertex, tracks, and impact parameters amongst others into a powerful discriminant. The training of the discriminator also covers scenarios where no secondary vertex has been reconstructed within a jet. In such cases, the compatibility of tracks with the primary vertex is condensed into the discriminant. A comparison of the performance of various b-tagging algorithms utilized within \gls{cms} is presented in Fig.~\ref{fig:reconstruction-btagging-algo}. It shows the misidentification probability of falsely tagging charm and light~(g,u,d,s) quarks as a function of the efficiency to identify true b~jets in simulation.

\myfigure{\label{fig:reconstruction-btagging-algo}Comparison of various b-tagging algorithms in simulation. The indicated version~2 refers to the algorithms in Run~2. The figure is taken from Ref.~\cite{CMS-PAS-BTV-15-001}.}{
\includegraphics[width=0.7\textwidth]{figures/reconstruction/btag_comparison.pdf}\hspace{0.1\textwidth}
}

The \glshere{csv} (Run~1) algorithm is employed in the 8~TeV and first 13~TeV (\gls{csv} version~2) analyses within this thesis. At their tight working points, a b-tagging efficiency of approximately 50\% with a misidentification probability of only 0.1\% is achieved. A new algorithm, called \glshere{cmva}, is utilized in the analysis of 13~TeV data recorded in 2016. It combines the output of various other b-tagging algorithms which includes also the \gls{csv} discriminant. Additionally, the results of \gls{mva} discriminators trained to identify low-$\pt$ electrons or muons inside a jet for b-tagging are taken as inputs as well. The final \gls{cmva} discriminant exhibits an improved rejection of charm and light quark jets compared to the other algorithms as shown in Fig.~\ref{fig:reconstruction-btagging-algo}~\cite{CMS-PAS-BTV-15-001}.

The b-tagging efficiency in simulation typically deviates somewhat from the one observed in data. This is corrected by applying efficiency scale factors $\epsilon_\mathrm{b}^\mathrm{data}/\epsilon_\mathrm{b}^\mathrm{sim.}$ to simulation which are derived from data. Multiple methods are used to measure the scale factors in either multijet data events, which are enriched with heavy-flavored jets by requiring close-by muons, or in events with two leptons and two jets yielding a $\ttbar$-enriched sample~\cite{CMS-PAS-BTV-13-001}. A weight is calculated for each simulated jet based on the ratio of probabilities between simulation and data that the jet was tagged, i.e. its b-tagging discriminator value is past a working point. For multiple working points the weight can be expressed as

\begin{align}
w^\mathrm{jet}=\frac{p_\mathrm{data}\big(\mathrm{jet}\,\big|~W_{i}<d^\mathrm{jet}<W_{i+1}\big)}{p_\mathrm{sim.}\big(\mathrm{jet}\,\big|~W_{i}<d^\mathrm{jet}<W_{i+1}\big)}
=\frac{
s^\mathrm{jet}_{i}\cdot\epsilon^\mathrm{jet}_{i}-s^\mathrm{jet}_{i+1}\cdot\epsilon^\mathrm{jet}_{i+1}}{\epsilon^\mathrm{jet}_{i}-\epsilon^\mathrm{jet}_{i+1}}
\end{align}

where $d^\mathrm{jet}$ denotes the value of the b-tagging discriminant, $W_{i}$ the working points $i=0\ldots N$, $\epsilon_i$ the efficiency measured in simulation, and $s_i$ the corresponding scale factors. In this equation, the scale factors and efficiencies for untagged jets ($i=0$) are set to $s_{0}=\epsilon_{0}=1$ whereas the efficiency of passing the highest working point $W_N$ is set to $\epsilon_{N+1}=0$. An event is reweighted by the multiplied weights from all jets passing the selection. The efficiencies and scale factors themselves depend on the reconstructed jet $\pt$, $\eta$ and flavor, where the latter is determined from the decay and hadronization history of a matched true jet. In case no true jet can be matched (e.g. the reconstructed jet is driven by \gls{pf} candidates from pileup interactions) a light flavored quark~(g,u,d,s) is assumed as its origin.



 
%##############################################
\section{Missing transverse energy}
%##############################################

The missing transverse momentum, \pvmiss, and energy, \met, is calculated from the momentum imbalance of the summed \gls{pf} candidate momenta as

\begin{equation}
\met=|\pvmiss|\,,\qquad \pvmiss=\colvec{2}{\pvmissx}{\pvmissy}=-\sum_{i}^\mathrm{\gls{pf}~cand.}\vec{p}_{\mathrm{T},i}\,.
\end{equation}

In analyses, it can be used to infer the summed transverse momenta of produced neutrinos which escape the \gls{cms} detector without being detected due to their very low interaction probability. In this thesis, one neutrino is expected to be produced in signal events stemming from the decay of a single top quark which can lead to significant missing transverse energy of about $\langle\met\rangle\approx50~\GeV$ on average. The $\pvmissz$ component cannot be calculated from the momentum imbalance since the boost along the z-axis of an event, determined by the initial parton momentum fractions $x_i$, cannot be reconstructed.

The \met scale is improved by propagating the corrected energy for \gls{pf} candidates which are clustered into jets to the missing transverse momentum. Only jets with a $\pt$ of at least $10~\GeV$ ($15~\GeV$) are considered for which energy calibrations are measured in 8~\TeV (13~\TeV) data respectively. The correction can be expressed as

\begin{subequations}
\begin{align}
\pvmiss^\mathrm{corr.}&=-~\sum_{i}^\mathrm{jets}~\vec{p}_{\mathrm{T},i}^\mathrm{\,corr.}~~-\sum_{i}^\mathrm{unclustered}\vec{p}_{\mathrm{T},i}^\mathrm{\,raw}\\
&=\pvmiss^\mathrm{raw}-~\sum_{i}^\mathrm{jets}\left(\, \vec{p}_{\mathrm{T},i}^\mathrm{\,full~\gls{jec}}~-~\vec{p}_{\mathrm{T},i}^\mathrm{\,\gls{pu}\mbox{-}only}\right)\,,
\end{align}
\end{subequations}

where $\vec{p}_{\mathrm{T},i}^\scriptn{\mathrm{\,\gls{pu}\mbox{-}only}}$ denotes the transverse jet momentum after applying only the first level of energy corrections which deals with the contribution from pileup. The resulting improvement is demonstrated in Fig.~\ref{fig:reconstruction-met}. The parallel component of the missing momentum vector $u_{\parallel}$ along the direction of a reconstructed $\mathrm{Z}$~boson or photon $\vec{q}_\mathrm{T}$ is shown in a ratio over the recoil momentum. The energy scale of the parallel \pvmiss component is reconstructed well within 3\% or better for momenta above $50~\GeV$ after propagating the applied jet energy corrections. At low momenta, the contribution from unclustered \gls{pf} candidates dominates which results in a degradation of the energy scale.

\myfigure{\label{fig:reconstruction-met}The average $\pvmiss$ component parallel to the recoiling $\mathrm{Z}/\gamma$ boson as a function of the boson's momentum. The figure is taken from Ref.~\cite{CMS-PAS-JME-12-002}.}{
\includegraphics[width=0.6\textwidth]{figures/reconstruction/met_recoil.pdf}
}

An additional correction can be applied to decrease the influence of pileup on the \met. Since typical inelastic \gls{pp} interactions do not produce any prompt neutrinos, pileup events will only lead to a smearing of the \met due to the finite detector response for measuring neutral particle momenta. This can be mitigated by subtracting the amount of charged and neutral energy associated to pileup vertices where the latter is estimated from the amount of charged hadron activity.


%##############################################
\section{Luminosity}
%##############################################

At the \gls{cms} interaction point, the luminosity delivered by the \gls{lhc} during collisions is determined by measuring certain process rates with so-called luminometers. These are the pixel detector, the \gls{hf} calorimeter, and the pixel luminosity telescope~\cite{Kornmayer:2039978} amongst others. The instantaneous luminosity is then calculated from the recorded process rate $R$ of the luminometer as

\begin{equation}
L\cdot\mathrm{d}t=\frac{R\cdot\mathrm{d}t}{\sigma_\mathrm{fid.}}\,,
\end{equation}

where $\sigma_\mathrm{fid.}=\sigma\cdot A$ is the fiducial cross section observed within the luminometer acceptance $A$. The fiducial cross section is estimated from so-called \glshere{vdm} scans during which the proton beams are first separated and then gradually crossed with each other. By fitting the rate as a function of the beam separation in such scans provides an absolute calibration of the luminometers. The most precise luminosity estimations for the data analyzed in this thesis are obtained with the pixel cluster counting method~\cite{CMS-PAS-LUM-13-001,CMS-PAS-LUM-15-001,CMS-PAS-LUM-17-001}. Here, the rate is defined as the number of pixel clusters reconstructed in the second and third pixel barrel layers per bunch crossing. The method profits from the low channel occupancy of the pixel detector which results in a linear dependency between the cluster rate and the instantaneous luminosity even in high pileup events with many particle tracks.

Simulated samples are typically overlaid with minimum bias events for which a predefined distribution of the number of \glshere{pu} interactions is assumed. A reweighting is performed to match the corresponding distribution of the amount of \gls{pu} interactions in data. For this, the average number of \gls{pu} interactions is estimated in data per luminosity section using $\langle N_\mathrm{\gls{pu}}\rangle=\sigma_\mathrm{\gls{pp}}\cdot L$ where $\sigma_\mathrm{\gls{pp}}$ denotes the total inelastic \gls{pp} cross section. The event weight is then derived from the ratio of the distributions of \gls{pu} interactions in data and simulation. The inelastic cross section has been measured in 13~TeV \gls{pp} collisions as $71.3\pm3.5~\mathrm{mb}$~\cite{CMS-PAS-FSQ-15-005}. However, a better agreement between data and simulation is obtained for pileup sensitive observables such as the number of primary vertices or the median of the transverse energy density, $\rho$, with a slightly lower cross section of $69~\mathrm{mb}$. \todo{min bias xsec for 8TeV}


%##############################################
\section{Summary of corrections}
%##############################################
\label{sec:reconstruction-summary}

Several corrections have been introduced throughout this chapter to improve the agreement between data and simulation. The corrections are also considered sources of systematic uncertainties in the presented analyses within this thesis. A summary of the corrections and associated uncertainties is provided in the following.

\begin{description}
\item[Lepton selection] The efficiencies for selecting isolated muons or electrons which pass dedicated tight identification criteria are corrected through data-to-simulation scale factors. In addition, the analyzed data events have been recorded using single muon or electron triggers whose efficiencies in simulation are also corrected to match the ones observed in data. The applied lepton scale factors are varied independently within one standard deviation of their measured uncertainties to assess the systematic impact on the measurements.
\item[Jet energy scale and resolution] The momenta of reconstructed jets in data and simulation are corrected to relate to the expected true jet energy derived from the hadronization products of partons in simulation. Residual corrections and a smearing procedure are applied to match the overall scale and resolution of the jet energy in data. The corrections are also propagated to the \met which improves its energy response as well. The systematic uncertainties arising from the measured energy and resolutions scale factors are estimated by varying them within their uncertainties and repeating the measurements with recalibrated jets and \met.
\item[Unclustered energy] The momentum of \gls{pf} candidates which are not clustered into jets is varied to estimate the uncertainty due their uncalibrated contributions to the missing transverse energy.
\item[B-tagging] Scale factors are applied in simulation to match the performance of an employed b-tagging algorithm in data. The systematic uncertainties are assessed for b and c~jets by varying their scale factors simultaneously while the scale factor for the mistagging rate for g,u,d,s~jets is varied independently.
\item[Pileup] The impact of pileup is estimated by varying the inelastic \gls{pp} cross section by $\pm5\%$ which changes the estimated distribution of true pileup interactions in data. The corresponding reweighting factors are rederived and applied to simulation.
\end{description}

