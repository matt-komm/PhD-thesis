%% Xheader by mKomm
%% Use with book (standard) document class not KOMA!

\usepackage[a4paper,total={12cm,20cm},centering,includehead]{geometry}
\usepackage[nouppercase,headsepline]{scrpage2}
\usepackage{ifthen}

\usepackage[T1]{fontenc}
\usepackage[latin9]{inputenc}
\usepackage{amsmath}


%\usepackage{lmodern}
\usepackage{mathpazo}
\usepackage[scaled]{helvet}
\usepackage{courier}

\usepackage[T1]{fontenc}

\pagestyle{scrheadings}
\usepackage{scrextend}
\usepackage{lipsum}
\usepackage{color}
\usepackage{xcolor} %more advance color usage
\definecolor{ucl}{rgb}{0.05,0.15,0.45}
\definecolor{gray}{rgb}{0.65,0.65,0.65}

\usepackage{array}%tabellanartige Strukturen z.B. fuer Formeln Spalten im mathematischen Modus
\usepackage{calc}%erweitert setlength etc. damit auch arithmetische Funktionen benutzt werden koennen
\usepackage{url}
\usepackage{breakurl}
\usepackage{chngcntr} %fuer nummerierung der figures, tables
\usepackage{microtype}
\usepackage{tocloft}
\usepackage{slashed}
\usepackage{afterpage}
\usepackage{subfloat}
\usepackage{setspace}
\usepackage{xr} %ref over documents
\usepackage{axodraw4j}
\usepackage[colorlinks=false,    
    hidelinks=true]{hyperref}
\usepackage{todonotes}
\usepackage{perpage}
\usepackage{nomencl} %list of abbreviations
\makenomenclature


\newcommand*{\numberfont}{\fontfamily{qcs}\selectfont}

%% Setup TOC
\setcounter{secnumdepth}{3}
\setcounter{tocdepth}{3}
\renewcommand{\cfttoctitlefont}{\normalfont\fontsize{18}{20}\selectfont\numberfont}
\renewcommand{\cftchapfont}{\numberfont}
\renewcommand{\cftsecfont}{}

\newcommand{\nocontentsline}[3]{}
\newcommand{\tocless}[2]{\bgroup\let\addcontentsline=\nocontentsline#1{#2}\egroup}
\newcommand{\appendixchapter}[1]{\tocless\chapter{#1}\addcontentsline{toc}{section}{\protect\numberline{\thechapter.}\rm#1}}

%% Setup HEADER/FOOTER
\clearscrheadfoot
\ihead{\headmark}
\renewcommand{\chaptermark}[1]{\markboth{{\numberfont\color{gray}\chaptername\ \thechapter.}\ #1}{}}
\renewcommand{\sectionmark}[1]{\markright{{\numberfont\color{gray}\thesection.}\ #1}}
\ohead[\pagemark]{\pagemark}
%\renewcommand{\pagemark}{\markboth{\bf\color{gray}\thepage}{\bf\color{gray}\thepage}}

\setlength{\headheight}{0.5\baselineskip}
\setheadsepline{0.6pt}[\color{gray}]
%Vergroessere head&foot Breite
%\setheadwidth[0.5cm]{text}
%\setfootwidth[0.5cm]{text}
%Headschrift
\renewcommand*{\headfont}{\numberfont\small\slshape}
%\renewcommand*{\headfont}{\numberfont\small}
%\renewcommand{\headrulewidth}{0.5pt}
%alternativ: \renewcommand*{\headfont}{\normalfont\sffamily\scshape\large}
%Footschrift
%\renewcommand*{\footfont}{\numberfont}
%Seitenzahlschrift
\renewcommand*{\pnumfont}{\numberfont\small\upshape}


\renewcommand*\chapterpagestyle{empty} %removes header from all chapter pages
\addtocontents{toc}{\protect\thispagestyle{empty}} %hack to remove also header from 1st TOC page

%\deftripstyle{ChapterStyle}{}{}{\pagemark}{}{}{} %define style w/o headings
%\renewcommand*\chapterpagestyle{ChapterStyle}
%\addtocontents{toc}{\protect\thispagestyle{ChapterStyle}} %hack to remove also header from 1st TOC page

\KOMAoptions{cleardoublepage=scrheadings} %adds header to cleared double pages


%% Setup Chapter Style
\renewcommand*{\chapterformat}{\fontsize{50}{0}\selectfont\color{gray}\numberfont\parbox[c][0mm][t]{3cm}{\vspace{-1cm}{\fontsize{16}{0}\selectfont\chaptername}\\[0.2cm]\thechapter.}}
\setkomafont{chapter}{\normalfont\fontsize{18}{20}\selectfont\numberfont}
\renewcommand*{\chapterheadstartvskip}{\vspace*{2.5cm}}
\renewcommand*{\chapterheadendvskip}{\vspace*{1cm}}

\renewcommand*{\sectionformat}{\color{gray}\numberfont\thesection.\ }
\setkomafont{section}{\normalfont\fontsize{14}{15}\selectfont\numberfont}

\renewcommand*{\subsectionformat}{\color{gray}\numberfont\thesubsection.\ }
\setkomafont{subsection}{\normalfont\fontsize{12}{13}\selectfont\numberfont}

\renewcommand*{\subsubsectionformat}{\color{gray}\numberfont\thesubsubsection.\ }
\setkomafont{subsubsection}{\normalfont\fontsize{11}{12}\selectfont\numberfont}

\RedeclareSectionCommands[
  beforeskip=0.8\baselineskip,
  afterskip=0.01\baselineskip
]{section,subsection,subsubsection}


%strecke zeilenabstände im table
\renewcommand{\arraystretch}{1.1}

%Schicke Bild- und Tabellenbeschreibungen
\usepackage[format=plain,indention=0.0cm,labelsep=colon,width=.93\textwidth]{caption} %use same as for parindent
\setkomafont{caption}{\small}
\setkomafont{captionlabel}{\small\numberfont}
\renewcommand{\thefigure}{\arabic{chapter}.\arabic{figure}}
\renewcommand{\thetable}{\arabic{chapter}.\arabic{table}}
%abstand zwischen caption und figure,table
\captionsetup[figure]{aboveskip=0.5\baselineskip,belowskip=0\baselineskip}
\captionsetup[table]{aboveskip=0\baselineskip,belowskip=0.5\baselineskip}
\setlength\floatsep{1.\baselineskip plus 3pt minus 2pt}
\setlength\textfloatsep{1.\baselineskip plus 3pt minus 2pt}
\setlength\intextsep{1.\baselineskip plus 3pt minus 2pt}

% New definition of square root:
% it renames \sqrt as \oldsqrt
\let\oldsqrt\sqrt
% it defines the new \sqrt in terms of the old one
\def\sqrt{\mathpalette\DHLhksqrt}
\def\DHLhksqrt#1#2{%
\setbox0=\hbox{$#1\oldsqrt{#2\,}$}\dimen0=\ht0
\advance\dimen0-0.2\ht0
\setbox2=\hbox{\vrule height\ht0 depth -\dimen0}%
{\box0\lower0.4pt\box2}}

%% change equation numbering style
\def\tagform@#1{\maketag@@@{\ignorespaces{\small\numberfont(#1)\enspace}\unskip\@@italiccorr}} %kill parenthesis
\renewcommand{\theequation}{\thechapter.\arabic{equation}.}


%% footnote
\def\@fnsymbol#1{\ifcase#1\or *\or **\or ***\or
   ****\or *****\or \else\@ctrerr\fi} %define alternative numbering using *, **, ***, ...
\renewcommand{\thefootnote}{\numberfont\arabic{footnote}} %style
\MakePerPage{footnote} %reset counter per new page
\renewcommand{\footnoterule}{%
  \kern -3pt
  {\color{gray}\hrule width 0.3\textwidth height 0.6pt}
  \kern 2pt
}

%Sonst================================================
\setlength{\jot}{0.4cm} %Vergroessert Zeilenabstand in align-Umgebung


\newcommand{\setupTextStyle}{
    %\setlength{\parindent}{0.35cm} %Absatzeinzug
    \setlength{\parindent}{0.cm} %Absatzeinzug
    \setlength{\parskip}{1.2ex plus 0.5ex minus 0.2ex}
    \renewcommand{\baselinestretch}{1.1}\normalsize


    %formel abstände 
    \setlength{\abovedisplayskip}{-2.\parskip plus 0.1cm}
    \setlength{\abovedisplayshortskip}{-2.\parskip plus 0.1cm}
    \setlength{\belowdisplayskip}{0.1cm plus 0.1cm}
    \setlength{\belowdisplayshortskip}{0.1cm plus 0.1cm}
}

